services:
  lyra:
    container_name: lyra
    image: ghcr.io/zetkin/lyra:0.4.1
    environment:
      - GIT_USER_EMAIL=lyra@zetkin.org
      - GIT_USER_NAME="Lyra Translator Bot"
    volumes:
      # note: adjust the path to the ssh key you want to use to access the git repositories
      - ~/.ssh/id_rsa:/home/nodeuser/.ssh/id_rsa:ro
      # note: adjust the path to the lyra-store-file you want to use
      - ~/lyra-store.json:/app/webapp/store.json
      - ./config:/app/config
  nginx:
    image: nginx:stable
    container_name: nginx-reverse-proxy
    restart: unless-stopped
    links:
      - lyra:lyra
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./certbot/www:/var/www/certbot                # ACME challenge
      - ./certbot/conf:/etc/letsencrypt               # certs + keys
